---
import { SEO } from "astro-seo";
import type { CollectionEntry } from "astro:content";
import { getCollection } from "astro:content";
interface Props {
  post: CollectionEntry<"posts">;
}

export async function getStaticPaths() {
  const posts = await getCollection("posts");
  return posts.map((post: CollectionEntry<"posts">) => ({
    params: { slug: post.slug },
    props: {
      post,
    },
  }));
}

const { post } = Astro.props;
const { Content } = await post.render();

// スライドかどうかを判定
const isSlide = post.data.type === "slide";

import "destyle.css";
import "../../styles/global.css";
import { Header } from "../../features/Header";
import { Footer } from "../../features/Footer";
import BlogPost from "../../components/BlogPost.astro";
import SlidePost from "../../components/SlidePost.astro";
import { Icon } from "astro-icon/components";
---

<!doctype html>
<html lang="ja">
  <head>
    <link rel="icon" href="/favicon.svg" />
    <meta name="viewport" content="width=device-width" />
    <SEO
      charset="UTF-8"
      title={`${post.data.title} | yutteee-portfolio`}
      description={post.data.description}
      openGraph={{
        basic: {
          title: post.data.title,
          type: "article",
          image: `${import.meta.env.PUBLIC_SITE_URL}/ogp/${post.slug}.png`,
        },
        image: {
          alt: post.data.title,
        },
      }}
      extend={{
        meta: [
          {
            name: "twitter:card",
            content: "summary_large_image",
          },
          { name: "twitter:site", content: "@yutteee-portfolio" },
          { name: "twitter:creator", content: "@yutteee" },
        ],
      }}
    />
  </head>
  <body>
    <Header currentPage="記事" client:load />
    <main class="container">
      <div class="breadcrumbs">
        <a href="/">トップ</a>
        <Icon name="weui:arrow-outlined" />
        <a href="/posts">記事</a>
        <Icon name="weui:arrow-outlined" />
        <div>ポスト</div>
      </div>

      {
        isSlide ? (
          <SlidePost post={post} />
        ) : (
          <BlogPost post={post} Content={Content} />
        )
      }
    </main>
    <Footer client:only />

    <style>
      .container {
        width: 100%;
        max-width: calc(70rem + 2rem);
        margin: 0 auto;
        padding: 96px 16px;
      }
      .breadcrumbs {
        display: flex;
        flex-wrap: wrap;
        align-items: center;
        gap: 0.5rem;
        padding: 0.5rem 1rem;
        background-color: var(--color-white);
        height: fit-content;
        width: fit-content;
        border-radius: 9999px;

        @media screen and (max-width: 1000px) {
          width: 100%;
        }

        a {
          color: var(--color-link);
          text-decoration: underline;
        }
      }
    </style>
  </body>
</html>
